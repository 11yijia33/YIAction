name: æ‰“åŒ…vueé¡¹ç›®
on: push

permissions:
  contents: write

jobs:
  npm-build:
    name: buildå·¥ä½œ
    runs-on: ubuntu-latest

    steps:
      - name: ä½¿ç”¨checkout
        uses: actions/checkout@v4

      - name: è®¾ç½®Node.jsç¯å¢ƒ
        uses: actions/setup-node@v4 # å®˜æ–¹Node.jså®‰è£…å·¥å…·

      - name: â¬ä¸‹è½½ä¾èµ–
        run: |
          npm cache clean --force  # å¼ºåˆ¶æ¸…ç†npmç¼“å­˜
          rm -rf node_modules package-lock.json  # åˆ é™¤å¯èƒ½æŸåçš„ä¾èµ–å’Œé”æ–‡ä»¶
          npm install  # é‡æ–°å®‰è£…ä¾èµ–
          if [ -d "node_modules/vite" ]; then
            echo "Vite å®‰è£…æˆåŠŸ"
          else
            echo "Vite å®‰è£…å¤±è´¥ï¼Œæ£€æŸ¥package.jsonæ˜¯å¦åŒ…å«vite"
            cat package.json  # è¾“å‡ºpackage.jsonå†…å®¹ç”¨äºæ’æŸ¥
            exit 1
          fi

      - name: ğŸ“¦æ‰“åŒ…é¡¹ç›®
        run: npm run build

      - name: ğŸš€éƒ¨ç½²
        uses: JamesIves/github-pages-deploy-action@v4
        with:
          branch: gh-pages
          folder: build
